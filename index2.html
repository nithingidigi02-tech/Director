<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Movie Platform â€” ULTIMATE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:system-ui;background:#020617;color:#e5e7eb}
header{padding:16px;text-align:center;font-size:22px;font-weight:700;
background:linear-gradient(90deg,#4f46e5,#6366f1)}
.container{max-width:1200px;margin:auto;padding:20px}
.card{background:#111827;border-radius:16px;padding:20px;margin-bottom:20px}
textarea,button,input{width:100%;padding:12px;margin-top:10px;
border-radius:10px;border:none;background:#020617;color:#fff}
button{background:#6366f1;font-weight:600;cursor:pointer}
canvas{width:100%;height:340px;background:#000;border-radius:14px}
.stage{position:relative}
.subtitle{position:absolute;bottom:20px;width:100%;
text-align:center;font-size:20px;text-shadow:0 3px 12px #000}
.sceneEditor{display:grid;grid-template-columns:1fr 1fr;gap:10px}
pre{background:#020617;padding:16px;border-radius:12px;white-space:pre-wrap}
</style>
</head>

<body>

<header>ðŸŽ¬ AI Movie Platform â€” ULTIMATE (FULL SHORT FILM ENGINE)</header>

<div class="container">

<div class="card">
<textarea id="idea" placeholder="Enter movie idea..."></textarea>
<button onclick="createMovie()">Create Movie</button>
<button onclick="saveProject()">Save Project</button>
<button onclick="loadProject()">Load Project</button>
</div>

<div class="card stage">
<canvas id="canvas" width="960" height="340"></canvas>
<div class="subtitle" id="subtitle"></div>
</div>

<div class="card">
<h3>Scene Editor</h3>
<div class="sceneEditor" id="sceneEditor"></div>
</div>

<div class="card">
<h3>Movie Log</h3>
<pre id="log">Waiting...</pre>
</div>

</div>

<script>
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
const subtitle=document.getElementById("subtitle");
const log=document.getElementById("log");
const editor=document.getElementById("sceneEditor");

let scenes=[];
let recorder,recordedChunks=[];
let musicCtx,oscillator;

function speak(text,voiceIndex=0){
  const u=new SpeechSynthesisUtterance(text);
  const voices=speechSynthesis.getVoices();
  u.voice=voices[voiceIndex%voices.length];
  u.rate=0.95;
  speechSynthesis.speak(u);
}

function startMusic(){
  musicCtx=new AudioContext();
  oscillator=musicCtx.createOscillator();
  oscillator.type="sine";
  oscillator.frequency.value=60;
  oscillator.connect(musicCtx.destination);
  oscillator.start();
}

function stopMusic(){
  oscillator.stop();
  musicCtx.close();
}

function generateScenes(){
  scenes=[
    {color:"#1e3a8a",duration:60,text:"A forbidden discovery awakens humanity.",voice:0},
    {color:"#312e81",duration:60,text:"The system begins rewriting reality.",voice:1},
    {color:"#7c2d12",duration:60,text:"Time fractures across dimensions.",voice:0},
    {color:"#020617",duration:60,text:"One soul must decide existence.",voice:1},
    {color:"#065f46",duration:60,text:"The universe rewinds. A new reality is born.",voice:0}
  ];
}

function renderEditor(){
  editor.innerHTML="";
  scenes.forEach((s,i)=>{
    editor.innerHTML+=`
      <input value="${s.text}" onchange="scenes[${i}].text=this.value">
      <input type="number" value="${s.duration}" onchange="scenes[${i}].duration=this.value">
    `;
  });
}

async function playScene(scene){
  return new Promise(resolve=>{
    let start=performance.now();
    subtitle.textContent=scene.text;
    speak(scene.text,scene.voice);

    function frame(now){
      const t=(now-start)/1000;
      ctx.fillStyle=scene.color;
      ctx.fillRect(0,0,canvas.width,canvas.height);

      ctx.fillStyle="#fff";
      ctx.font="26px system-ui";
      ctx.fillText("AI GENERATED FILM",40,180);

      if(t<scene.duration){
        requestAnimationFrame(frame);
      }else{
        subtitle.textContent="";
        resolve();
      }
    }
    requestAnimationFrame(frame);
  });
}

async function createMovie(){
  log.textContent="Movie started...\n";
  generateScenes();
  renderEditor();
  startMusic();

  const stream=canvas.captureStream(30);
  recorder=new MediaRecorder(stream,{mimeType:"video/webm"});
  recordedChunks=[];
  recorder.ondataavailable=e=>recordedChunks.push(e.data);
  recorder.onstop=saveVideo;
  recorder.start();

  for(const s of scenes){
    await playScene(s);
  }

  stopMusic();
  recorder.stop();
}

function saveVideo(){
  const blob=new Blob(recordedChunks,{type:"video/webm"});
  const url=URL.createObjectURL(blob);
  const a=document.createElement("a");
  a.href=url;
  a.download="ai_short_film.webm";
  a.click();
  log.textContent+="Movie exported successfully.\n";
}

function saveProject(){
  localStorage.setItem("movieProject",JSON.stringify(scenes));
  log.textContent+="Project saved.\n";
}

function loadProject(){
  const data=localStorage.getItem("movieProject");
  if(data){
    scenes=JSON.parse(data);
    renderEditor();
    log.textContent+="Project loaded.\n";
  }
}
</script>

</body>
</html>
